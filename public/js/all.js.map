{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["$(document).ready(function () {\n  var main = (function () {\n    $boardBody = $('#board-body');\n    $boardHead = $('#board-head');\n    $playerName = $('#player-name');\n    var width = 7;\n    var height = 6;\n    var board = [];\n    var boardArr = [];\n    var turn = 0;\n    var moves = 0;\n    var isAi = false;\n    var aiFull = [];\n    var lastColumn = 0;\n\n    var _player1 = 1;\n    var _player2 = 2;\n\n    var getDiff = function (choices) {\n      var newChoices = [];\n      for (var key in choices) {\n        if (aiFull.indexOf(choices[key]) < 0) {\n          newChoices.push(choices[key]);\n        }\n      }\n\n      return newChoices;\n    };\n\n    var aiLogic = function () {\n      var choices = [1, 2, 3, 4, 5, 6, 7];\n\n      //minimize to near;\n      if (lastColumn > 0) {\n        choices = [];\n        if (lastColumn - 1 > 0) {\n          choices.push(lastColumn - 1);\n        }\n\n        choices.push(lastColumn);\n        choices.push(lastColumn + 1);\n      }\n\n      //remove full from choices\n      choices = getDiff(choices);\n\n      var index = Math.floor(Math.random() * choices.length);\n      var num = choices[index];\n      console.log(choices, index, num);\n\n      if (playerDone(num) === false) {\n        aiFull.push(num);\n        aiLogic();\n      } else {\n        aiFull = [];\n      }\n    };\n\n    var changePlayer = function () {\n      turn = (turn === _player1) ? _player2 : _player1;\n      $playerName.text(turn);\n      if (isAi && turn === _player2) {\n        aiLogic();\n      }\n    };\n\n    var loadBoard = function () {\n      var boxes = [];\n      var drops = [];\n\n      changePlayer();\n\n      $boardBody.empty();\n      $boardHead.empty();\n      $('.board-holder').show();\n\n      for (var t = 1; t <= width; t++) {\n        var template = '<button data-id=\"' + t +\n              '\" class=\"dropper btn btn-success\" type=\"button\">' +\n              '<span class=\"glyphicon glyphicon-arrow-down\"></span>' +\n            '</button>';\n        drops.push(template);\n      }\n\n      for (var i = height; i >= 1; i--) {\n        for (var j = width; j >= 1; j--) {\n          var boxTemplate = '<li class=\"box-holder\">' +\n              '<div id=\"slot_' + i + '_' + j + '\" class=\"slot\">' +\n              i + ':' + j +\n              '</div>' +\n              '</li>';\n          boxes.push(boxTemplate);\n        }\n      }\n\n      $boardBody.append(boxes.join(''));\n      $boardHead.append(drops.join(''));\n    };\n\n    var checkHorizontal = function (row, col) {\n      var max = col + 3;\n\n      for (var i = col; i <= max; i++) {\n        if (!$('#slot_' + row + '_' + i).hasClass('player-' + turn)) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n\n    var checkVertical = function (row, col) {\n      var max = row + 3;\n\n      for (var j = row; j <= max; j++) {\n        if (!$('#slot_' + j + '_' + col).hasClass('player-' + turn)) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n\n    var checkDiagonalUp = function (row, col) {\n      var max = row + 3;\n\n      i = col;\n      for (var j = row; j <= max; j++) {\n        if (!$('#slot_' + j + '_' + i).hasClass('player-' + turn)) {\n          return false;\n        }\n\n        i++;\n      }\n\n      return true;\n    };\n\n    var checkDiagonalDown = function (row, col) {\n      var max = col + 3;\n\n      j = row;\n      for (var i = col; i <= max; i++) {\n        if (!$('#slot_' + j + '_' + i).hasClass('player-' + turn)) {\n          return false;\n        }\n\n        j--;\n      }\n\n      return true;\n    };\n\n    var checkWinner = function (row, col, turn) {\n      //check horizontal\n      var precedingCol = col - 3;\n      for (var i = precedingCol; i <= col; i++) {\n        if (i > 0 && $('#slot_' + row + '_' + i).hasClass('player-' + turn)) {\n          if (checkHorizontal(row, i)) {\n            return true;\n          }\n        }\n      }\n\n      //check vertical\n      var precedingRow = row - 3;\n      for (var j = precedingRow; j <= row; j++) {\n        if (j > 0 && $('#slot_' + j + '_' + col).hasClass('player-' + turn)) {\n          if (checkVertical(j, col)) {\n            return true;\n          }\n        }\n      }\n\n      //check diagonal up\n      //i=column j=row\n      precedingCol = col - 3;\n      j = row - 3;\n      for (i = precedingCol; i <= col; i++) {\n        if (j > 0 && $('#slot_' + j + '_' + i).hasClass('player-' + turn)) {\n          if (checkDiagonalUp(j, i)) {\n            return true;\n          }\n        }\n\n        j++;\n      }\n\n      //check diagonal down\n      //i=column j=row\n      precedingCol = col - 3;\n      j = row + 3;\n      for (i = precedingCol; i <= col; i++) {\n        if (j > 0 && $('#slot_' + j + '_' + i).hasClass('player-' + turn)) {\n          if (checkDiagonalDown(j, i)) {\n            return true;\n          }\n        }\n\n        j--;\n      }\n\n      return false;\n    };\n\n    var finishGame = function () {\n      $('.board-holder').hide();\n      moves = 0;\n    };\n\n    var checkMoves = function () {\n      moves++;\n      if (moves >= 42) {\n        return false;\n      }\n\n      return true;\n    };\n\n    var playerDone = function (colId) {\n      lastColumn = colId;\n      //check if full column\n      if ($('#slot_' + height + '_' + colId).hasClass('player')) {\n        if (turn === _player1 || !isAi) {\n          alert('The column is full.');\n        }\n\n        return false;\n      }\n\n      for (var i = 1; i <= height; i++) {\n        if (!$('#slot_' + i + '_' + colId).hasClass('player')) {\n\n          $('#slot_' + i + '_' + colId).addClass('player-' + turn).addClass('player');\n          break;\n        }\n      }\n\n      if (checkWinner(i, colId, turn)) {\n        alert('Player ' + turn + ' won!');\n        finishGame();\n      } else {\n        if (checkMoves()) {\n          changePlayer();\n        } else {\n          alert('The game is Draw!');\n          finishGame();\n        }\n      }\n\n      return true;\n    };\n\n    var events = function () {\n      //Events\n      $('#start').on('click', function () {\n        isAi = false;\n        loadBoard();\n      });\n\n      $('#start_ai').on('click', function () {\n        isAi = true;\n        loadBoard();\n      });\n\n      $boardHead.on('click', '.dropper', function () {\n        playerDone($(this).data('id'));\n      });\n    };\n\n    var init = function () {\n      events();\n    };\n\n    return {\n      init: init,\n    };\n  })();\n\n  main.init();\n});\n"],"sourceRoot":"/source/"}